<!DOCTYPE html>
<html>

<head>
	<link href='/public/stylesheet.css' rel='stylesheet'>
	<link href='/public/style.css' rel='stylesheet'>
</head>

<body ng-app="D3App" class='body'>
	<Video class='background' autoplay loop>
		<source src="/public/videos/malthael.webm" type="video/webm" />
		<source src="/public/videos/malthael.mp4" type="video/mp4" />
	</video>

	<div class='container' ng-controller="SearchBar">

		<div class='search-bar-and-heros-container'>
			<div class='search-bar-inputs'>
				<input type='text' ng-model='battleTag' />
				<input style="cursor: url('/Public/images/CursorDI.png'), auto;" type='button' value='"I need a hero"- Bonnie Tyler' ng-click='getHeroInformation(battleTag)'
				/>
			</div>
			<div ng-repeat='hero in heroList' ng-click='displayHeroInformation(hero)'>
				<div class='hero' ng-model='hero'>
					{{hero.name}} - Lvl: {{hero.level}} , {{hero.class}}
				</div>
			</div>
		</div>

		<div class='hero-equipment-container' ng-controller='Displayer' ng-show="show">
			<div class='hero-stats'>
				Character Stats <br> {{character.name}} - Lvl: {{character.level}} , {{character.class}} <br>
				Paragon Level : {{character.paragonLevel}} <br>
				<div class = "stat-listing">
				  Life: {{character.life}} <br>
				  Damage: {{character.damage}} <br>
				  Toughness: {{character.toughness}} <br>
				  Healing: {{character.healing}} <br>
				  Attack Speed: {{character.attackSpeed}} <br>
				  Armor: {{character.armor}} <br>
				  Strength: {{character.strength}} <br>
				  Dexterity: {{character.dexterity}} <br>
				  Vitality: {{character.vitality}} <br>
				  Intelligence: {{character.intelligence}} <br>
                  Physical Resist: {{character.physicalResist}} <br>
				  Fire Resist: {{character.fireResist}} <br>
				  Cold Resist:{{character.coldResist}} <br>
				  Lightning Resist: {{character.lightningResist}}<br>
	              Posion Resist: {{character.poisonResist}} <br>
				  Arcane Resist: {{character.arcaneResist}}<br>
				  Crit Damage: {{character.critDamage}}<br>
				  Block Chance:  {{character.blockChance}} <br>
				  Block Amount: {{character.blockAmountMin}} <br>
				  Block Amount Max: {{character.blockAmountMax}} <br>
				  Damage Increase: {{character.damageIncrease}} <br>
				  Critical Chance: {{character.critChance}} <br>
				  Damage Reduction: {{character.damageReduction}} <br>
				  Thorn Damage: {{character.thorns}} <br>
				  Life Steal : {{character.lifeSteal}} <br>
				  Life Per Kill: {{character.lifePerKill}} <br>
				  Gold Find: {{character.goldFind}} <br>
				  Magic Find: {{character.magicFind}} <br>
				  Life On Hit: {{character.lifeOnHit}} <br>
				  Primary Resource: {{character.primaryResource}} <br>
				  Secondary Resource: {{character.secondaryResource}} <br>
				  </div>
			</div>
			<div class='hero-equipment'>
			<table> <tr><th> </th><th> 	Hero's Equipment </th><th></th></tr>
			        <tr><td><a href ="http://us.battle.net/d3/en/{{character.shoulders.tooltipParams}}" ><img ng-src="http://media.blizzard.com/d3/icons/items/large/{{character.shoulders.icon}}.png" ></a></td>
					<td><a href ="http://us.battle.net/d3/en/{{character.head.tooltipParams}}" ><img ng-src="http://media.blizzard.com/d3/icons/items/large/{{character.head.icon}}.png" ></a></td>
					<td><a href ="http://us.battle.net/d3/en/{{character.neck.tooltipParams}}" ><img ng-src="http://media.blizzard.com/d3/icons/items/large/{{character.neck.icon}}.png" ></a></td></tr>
		            <tr><td><a href ="http://us.battle.net/d3/en/{{character.hands.tooltipParams}}" ><img ng-src="http://media.blizzard.com/d3/icons/items/large/{{character.hands.icon}}.png" ></a></td>
					<td><a href ="http://us.battle.net/d3/en/{{character.torso.tooltipParams}}" ><img ng-src="http://media.blizzard.com/d3/icons/items/large/{{character.torso.icon}}.png" ></a></td>
					<td><a href ="http://us.battle.net/d3/en/{{character.bracers.tooltipParams}}" ><img ng-src="http://media.blizzard.com/d3/icons/items/large/{{character.bracers.icon}}.png" ></a></td></tr>
					<tr><td><a href ="http://us.battle.net/d3/en/{{character.rightFinger.tooltipParams}}" ><img ng-src="http://media.blizzard.com/d3/icons/items/large/{{character.rightFinger.icon}}.png" ></a></td>
					<td><a href ="http://us.battle.net/d3/en/{{character.waist.tooltipParams}}" ><img ng-src="http://media.blizzard.com/d3/icons/items/large/{{character.waist.icon}}.png" ></a></td>
					<td><a href ="http://us.battle.net/d3/en/{{character.leftFinger.tooltipParams}}" ><img ng-src="http://media.blizzard.com/d3/icons/items/large/{{character.leftFinger.icon}}.png" ></a></td></tr>
					<tr><td><a href ="http://us.battle.net/d3/en/{{character.mainHand.tooltipParams}}" ><img ng-src="http://media.blizzard.com/d3/icons/items/large/{{character.mainHand.icon}}.png" ></a></td>
					<td><a href ="http://us.battle.net/d3/en/{{character.legs.tooltipParams}}" ><img ng-src="http://media.blizzard.com/d3/icons/items/large/{{character.legs.icon}}.png" ></a></td>
					<td><a href ="http://us.battle.net/d3/en/{{character.offHand.tooltipParams}}" ><img ng-src="http://media.blizzard.com/d3/icons/items/large/{{character.offHand.icon}}.png" ></a></td></tr>
				    <tr><td></td>
					<td><a href ="http://us.battle.net/d3/en/{{character.feet.tooltipParams}}" ><img ng-src="http://media.blizzard.com/d3/icons/items/large/{{character.feet.icon}}.png" ></a></td>
					<td></td></tr>
			</table>
		
			</div>
		</div>

	</div>



	<!--  <script>

	const function run(interval, frames) {
		var int = 1;
		function func(){
			document.body.class = 'b'+int
			int++
			if (int === frames) {int = 1;}
		}
		console.log(int)
		var swap = window.setInterval(func, interval);
	}
	run (1000,10);
<video xmlns="http://www.w3.org/1999/xhtml" id="malthael-video" class="video-bg is-active" loop="loop" poster="/public/images/malthael.jpg">
</script> -->

	<!-- <audio controls className='audio' autoplay>
	{"<source src='/Public/03-new-tristram.mp3' type='audio/mp3'>"}
</audio> -->

	<script src='https://cdnjs.cloudflare.com/ajax/libs/angular.js/1.5.8/angular.js'></script>
	<script>var app = angular.module('D3App', []);

app.controller('SearchBar', function($scope, heroBackendService){
	$scope.show = false;
	$scope.heroList;
	$scope.battleTag = 'slayeneq-1864';
	$scope.selectedId ='';

	$scope.getHeroInformation = function (tag){
		heroBackendService.getProfile(tag).then(function(response){
		$scope.heroList = response;
		}) };
		
	$scope.displayHeroInformation = function (hero){
		$scope.selectedId=hero.characterID;
		 heroBackendService.getStats($scope.selectedId,$scope.battleTag).then(function(response){
			 $scope.character = {};	   	 
       $scope.character = response;	 
	   $scope.character.name = hero.name;
	   $scope.character.level = hero.level;
	   $scope.character.class = hero.class;	 
	   $scope.character.paragonLevel = hero.paragonLevel;
	   console.log(hero)

	   $scope.show = true; 
	   })
	   .then(function(){heroBackendService.getGear($scope.selectedId,'feet')	   
		   .then(function(response){ $scope.character.feet ={};	$scope.character.feet = response; })
	       .then(function(){heroBackendService.getGear($scope.selectedId,'head') 
		   .then(function(response){ $scope.character.head ={};	$scope.character.head = response; })
           .then(function(){heroBackendService.getGear($scope.selectedId,'neck')   
		   .then(function(response){ $scope.character.neck ={};	$scope.character.neck = response; })
		   .then(function(){heroBackendService.getGear($scope.selectedId,'waist')   
		   .then(function(response){ $scope.character.waist ={};	$scope.character.waist = response; })  
           .then(function(){heroBackendService.getGear($scope.selectedId,'shoulders')   
		   .then(function(response){ $scope.character.shoulders ={};	$scope.character.shoulders = response; })  
           .then(function(){heroBackendService.getGear($scope.selectedId,'bracers')   
		   .then(function(response){ $scope.character.bracers ={};	$scope.character.bracers = response; })  
           .then(function(){heroBackendService.getGear($scope.selectedId,'hands')   
		   .then(function(response){ $scope.character.hands ={};	$scope.character.hands = response; })  
           .then(function(){heroBackendService.getGear($scope.selectedId,'torso')   
		   .then(function(response){ $scope.character.torso ={};	$scope.character.torso = response; })  
           .then(function(){heroBackendService.getGear($scope.selectedId,'rightFinger')   
		   .then(function(response){ $scope.character.rightFinger ={};	$scope.character.rightFinger = response; })  
           .then(function(){heroBackendService.getGear($scope.selectedId,'mainHand')   
		   .then(function(response){ $scope.character.mainHand ={};	$scope.character.mainHand = response; })  
           .then(function(){heroBackendService.getGear($scope.selectedId,'offHand')   
		   .then(function(response){ $scope.character.offHand ={};	$scope.character.offHand = response; })  
           .then(function(){heroBackendService.getGear($scope.selectedId,'legs')   
		   .then(function(response){ $scope.character.legs ={};	$scope.character.legs = response; })  
           .then(function(){heroBackendService.getGear($scope.selectedId,'leftFinger')   
		   .then(function(response){ $scope.character.leftFinger ={};	$scope.character.leftFinger = response; 
		   console.log($scope.character)})  
	   })})})})})})})})})})})})})}
	})

	app.controller('Displayer', function($scope, $http, heroBackendService) {
	  
	   $scope.getCharacter = function (){
		   return $scope.character;
	   }

	
	$scope.showId = function( ){
		return $scope.selectedId;
	}
	$scope.showbattleTag = function( ){
		return $scope.battleTag;
	}		
					
	})

	app.factory('heroBackendService', function($http){
		serviceObj = {};
		serviceObj.getProfile = function (tag ){
           var chars = $http({method: 'Get', url: '/profile?id=' + tag})
		   .then(function(response){
			  return response.data;
		      })
		   return chars;
		};
       serviceObj.getStats = function(charId,battleTag){
		   var char = $http({method: 'Get', url: '/character?charId='+charId+'&id='+battleTag}) .then(function(response){
			  return response.data[0];
		      })
		   return char;
	   }
          serviceObj.getGear = function(charId,slot){
		   var char = $http({method: 'Get', url: '/character/item?charId='+charId+'&slot='+slot}) .then(function(response){
			 
			  return response.data;
		      })
		   return char;
	   }
 return serviceObj;
	})
	 </script>

	<!-- script will download and display the tooltip parameters on any link pointing to a diablo 3 item skill or skill calculator 
//                                
//http://media.blizzard.com/d3/icons/items/large/unique_gloves_set_02_p2_demonhunter_male.png 
// icons are available for skills or items (items take large or small sizes, skills have pixel size allotments 21, 42 or 64);
//.png name is stored in items or skills database table under icon.
-->
	<script src="http://us.battle.net/d3/static/js/tooltips.js"></script>
</body>

</html>